@model WebQuanLyNhaKhoa.Data.BenhNhan
@{
    ViewData["Title"] = "Create";
    Layout = "~/Views/Shared/_LayoutCustomer.cshtml";
}
<style>
    header {
        position: relative;
    }

</style>

<div class="container-xxl py-5">
    <div class="container">
        <div class="row g-5">
            <div class="col-lg-6 wow fadeInUp" data-wow-delay="0.1s">
                <p class="d-inline-block border rounded-pill py-1 px-4">Đăng ký khám</p>
                <h1 class="mb-4">Make An Appointment To Visit Our Doctor</h1>
                <p class="mb-4">Hãy đăng kí lịch khám để gặp gỡ các nha sĩ có nhiều năm kinh nghiệm của chúng tôi. Chúng tôi xin hứa sẽ giúp cho hàm răng của bạn trắng sáng và ngày càng mạnh khỏe hơn</p>
                <div class="bg-light rounded d-flex align-items-center p-5 mb-4">
                    <div class="d-flex flex-shrink-0 align-items-center justify-content-center rounded-circle bg-white" style="width: 55px; height: 55px;">
                        <i class="fa fa-phone-alt text-primary"></i>
                    </div>
                    <div class="ms-4">
                        <p class="mb-2">Call Us Now</p>
                        <h5 class="mb-0">+0348859428</h5>
                    </div>
                </div>
                <div class="bg-light rounded d-flex align-items-center p-5">
                    <div class="d-flex flex-shrink-0 align-items-center justify-content-center rounded-circle bg-white" style="width: 55px; height: 55px;">
                        <i class="fa fa-envelope-open text-primary"></i>
                    </div>
                    <div class="ms-4">
                        <p class="mb-2">Mail Us Now</p>
                        <h5 class="mb-0">nhakhoahoanmy@gmail.com</h5>
                    </div>
                </div>

            </div>
            <div class="col-lg-6 wow fadeInUp" data-wow-delay="0.5s">
                <div class="bg-light rounded h-100 d-flex align-items-center p-5">

                    <form id="createBenhNhan" class="row g-3" style="align-items:center" class="p-[20px]" method="post" enctype="multipart/form-data">
                    
                        <div class="my-5 mx-3">
                            <label asp-for="HoTen" class="mb-3 block text-sm font-medium text-black">
                                Name
                            </label>
                            <input asp-for="HoTen" type="text" placeholder="Enter your full name" class="w-full rounded border-[1.5px] border-stroke bg-transparent px-5 py-3 font-normal text-black outline-none transition focus:border-primary active:border-primary disabled:cursor-default disabled:bg-whiter dark:border-form-strokedark dark:bg-form-input dark:text-black dark:focus:border-primary">
                            <span asp-validation-for="HoTen" class="text-danger"></span>
                        </div>
                        <!--Name Patient End-->
                        <div class="my-5 mx-3">
                            <div>
                                <input asp-for="Gioi" type="radio" name="gender" value="True" />
                                <span>Nữ</span>

                             </div>
                             <div>
                                 <input asp-for="Gioi" type="radio" name="gender" value="False" />
                                 <span>Nam</span>
                             </div>
                         </div>
                         <!--Age Patient Start-->
                         <div class="my-5 mx-3">
                             <label asp-for="NamSinh" class="mb-3 block text-sm font-medium text-black">
                                 Age:
                             </label>
                             <input asp-for="NamSinh" type="text" placeholder="Enter your age" class="w-full rounded border-[1.5px] border-stroke bg-transparent px-5 py-3 font-normal text-black outline-none transition focus:border-primary active:border-primary disabled:cursor-default disabled:bg-whiter dark:border-form-strokedark dark:bg-form-input  dark:focus:border-primary">
                         </div>
                         <!--Age Patient End-->
                         <!--Tel Patient Start-->
                         <div class="my-5 mx-3">
                             <label asp-for="Sdt" class="mb-3 block text-sm font-medium text-black">
                                 Telephone:
                             </label>
                             <input asp-for="Sdt" type="tel" placeholder="Enter your telephone" class="w-full rounded border-[1.5px] border-stroke bg-transparent px-5 py-3 font-normal text-black outline-none transition focus:border-primary active:border-primary disabled:cursor-default disabled:bg-whiter dark:border-form-strokedark dark:bg-form-input  dark:focus:border-primary">
                         </div>
                         <!--Tel Patient End-->
                         <!--Address  Patient Start-->
                         <div class="my-5 mx-3">
                             <label asp-for="DiaChi" class="mb-3 block text-sm font-medium text-black">
                                 Address:
                             </label>
                             <input asp-for="DiaChi" type="text" placeholder="Enter your address" class="w-full rounded border-[1.5px] border-stroke bg-transparent px-5 py-3 font-normal text-black outline-none transition focus:border-primary active:border-primary disabled:cursor-default disabled:bg-whiter dark:border-form-strokedark dark:bg-form-input dark:focus:border-primary">
                         </div>
                         <!--Address Patient End-->
                         <div class="my-5 mx-3">
                             <label asp-for="NgayKhamDau" class="mb-3 block text-sm font-medium text-black">
                                 Registration Day:
                             </label>
                             <input asp-for="NgayKhamDau" type="datetime-local" placeholder="Enter your Registration Day" class="w-full rounded border-[1.5px] border-stroke bg-transparent px-5 py-3 font-normal text-black outline-none transition focus:border-primary active:border-primary disabled:cursor-default disabled:bg-whiter dark:border-form-strokedark dark:bg-form-input dark:focus:border-primary">
                         </div>
                         @* <div class="col-12">
                             <textarea class="form-control border-0" rows="5" placeholder="Describe your problem"></textarea>
                         </div>
                         <div class="col-12">
                             <button type="submit" class="btn btn-primary w-100 py-3">Book Appointment</button>
                         </div>
                     </form> *@
                    <form id="createBenhNhan1" class="p-[20px]" method="post" enctype="multipart/form-data">
                        <div class="p-6.5">

                            <!--Name Patient Start-->
                            <div class="my-5 mx-3">
                                <label asp-for="HoTen" class="mb-3 block text-sm font-medium text-black">
                                    Name
                                </label>
                                <input asp-for="HoTen" type="text" placeholder="Enter your full name" class="w-full rounded border-[1.5px] border-stroke bg-transparent px-5 py-3 font-normal text-black outline-none transition focus:border-primary active:border-primary disabled:cursor-default disabled:bg-whiter dark:border-form-strokedark dark:bg-form-input dark:text-black dark:focus:border-primary">
                                <span asp-validation-for="HoTen" class="text-danger"></span>
                            </div>
                            <!--Name Patient End-->
                            <div class="my-5 mx-3">
                                <div>
                                    <input asp-for="Gioi" type="radio" name="gender" value="True" />
                                    <span>Nữ</span>

                                </div>
                                <div>
                                    <input asp-for="Gioi" type="radio" name="gender" value="False" />
                                    <span>Nam</span>
                                </div>
                            </div>
                            <!--Age Patient Start-->
                            <div class="my-5 mx-3">
                                <label asp-for="NamSinh" class="mb-3 block text-sm font-medium text-black">
                                    Age:
                                </label>
                                <input asp-for="NamSinh" type="text" placeholder="Enter your age" class="w-full rounded border-[1.5px] border-stroke bg-transparent px-5 py-3 font-normal text-black outline-none transition focus:border-primary active:border-primary disabled:cursor-default disabled:bg-whiter dark:border-form-strokedark dark:bg-form-input  dark:focus:border-primary">
                            </div>
                            <!--Age Patient End-->
                            <!--Tel Patient Start-->
                            <div class="my-5 mx-3">
                                <label asp-for="Sdt" class="mb-3 block text-sm font-medium text-black">
                                    Telephone:
                                </label>
                                <input asp-for="Sdt" type="tel" placeholder="Enter your telephone" class="w-full rounded border-[1.5px] border-stroke bg-transparent px-5 py-3 font-normal text-black outline-none transition focus:border-primary active:border-primary disabled:cursor-default disabled:bg-whiter dark:border-form-strokedark dark:bg-form-input  dark:focus:border-primary">
                            </div>
                            <!--Tel Patient End-->
                            <!--Address  Patient Start-->
                            <div class="my-5 mx-3">
                                <label asp-for="DiaChi" class="mb-3 block text-sm font-medium text-black">
                                    Address:
                                </label>
                                <input asp-for="DiaChi" type="text" placeholder="Enter your address" class="w-full rounded border-[1.5px] border-stroke bg-transparent px-5 py-3 font-normal text-black outline-none transition focus:border-primary active:border-primary disabled:cursor-default disabled:bg-whiter dark:border-form-strokedark dark:bg-form-input dark:focus:border-primary">
                            </div>
                            <!--Address Patient End-->
                            <div class="my-5 mx-3">
                                <label asp-for="NgayKhamDau" class="mb-3 block text-sm font-medium text-black">
                                    Registration Day:
                                </label>
                                <input asp-for="NgayKhamDau" type="datetime-local" placeholder="Enter your Registration Day" class="w-full rounded border-[1.5px] border-stroke bg-transparent px-5 py-3 font-normal text-black outline-none transition focus:border-primary active:border-primary disabled:cursor-default disabled:bg-whiter dark:border-form-strokedark dark:bg-form-input dark:focus:border-primary">
                            </div>

                            @* <div class="my-5 mx-3">
                            <label class="mb-3 block text-sm font-medium text-black">
                            Any comments or suggestions?
                            </label>
                            <textarea rows="6" placeholder="Type here" class="w-full rounded border-[1.5px] border-stroke bg-transparent px-5 py-3 font-normal text-black outline-none transition focus:border-primary active:border-primary disabled:cursor-default disabled:bg-whiter dark:border-form-strokedark dark:bg-form-input  dark:focus:border-primary"></textarea>
                            </div> *@

                            <button type="submit" class="w-full rounded-lg px-4 py-2 bg-blue-500 text-blue-100 hover:bg-blue-600 duration-300">Create Patient</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
@section Scripts {
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const form = document.getElementById('createBenhNhan');
            if (form) {
                form.addEventListener("submit", async (event) => {
                    event.preventDefault();

                    const benhNhanData = {
                        HoTen: document.querySelector("[name='HoTen']").value,
                        Gioi: document.querySelector("[name='gender']:checked").value === "True",
                        NamSinh: parseInt(document.querySelector("[name='NamSinh']").value),
                        Sdt: document.querySelector("[name='Sdt']").value,
                        DiaChi: document.querySelector("[name='DiaChi']").value,
                        NgayKhamDau: document.querySelector("[name='NgayKhamDau']").value
                    };

                    console.log('Data being sent:', benhNhanData);

                    try {
                        const response = await fetch('/BookAppointment/api/PostBenhNhan', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify(benhNhanData)
                        });

                        if (response.ok) {
                            const result = await response.json();
                            console.log("Patient created successfully:", result);
                            alert("Patient created successfully!");
                            window.location.href = "/BookAppointment";
                        } else {
                            const errorText = await response.text();
                            console.error("Failed to create patient:", errorText);
                            alert("Failed to create patient.");
                        }
                    } catch (error) {
                        console.error("Error:", error);
                        alert("An error occurred while creating the patient.");
                    }
                });
            } else {
                console.error("Form with ID 'createBenhNhan' not found.");
            }
        });
    </script>
}




